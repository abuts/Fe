function [D,x0,alpha,e_sw,Icr,dIcr] = Ei400_uvw111_at110ver()
% simplified verification script, which allows one to check
% how do sqw cut works

%-------------------------------------------------
% Parameters :
%
data_source= fullfile(pwd,'Data','Fe_ei401.sqw');

bragg = [1,1,0];  % selected bragg
%
% Cut properties:
%
cut_direction=[1,-1,1];
dE = 2.5;
dK = 0.1;
%
% Points on Q-dE plane to make 1D cuts
cut_p =  [ -3.939015e-01, 150;
-3.871115e-01, 146;
-3.802073e-01, 142;
-3.731832e-01, 138;
-3.660326e-01, 134;
-3.587485e-01, 130;
-3.513229e-01, 126;
-3.437475e-01, 122;
-3.360127e-01, 118;
-3.281080e-01, 114;
-3.200217e-01, 110;
-3.117408e-01, 106;
-3.032503e-01, 102;
-2.945336e-01, 98;
-2.855715e-01, 94;
-2.763421e-01, 90;
-2.668200e-01, 86;
-2.569753e-01, 82;
-2.467729e-01, 78;
-2.361707e-01, 74;
-2.251176e-01, 70;
-2.135508e-01, 66;
-2.013911e-01, 62;
-1.885369e-01, 58;
-1.748534e-01, 54;
-1.601558e-01, 50;
-1.441786e-01, 46;
-1.265146e-01, 42;
-1.064806e-01, 38;
-8.275028e-02, 34;
-5.193313e-02, 30;
1.237915e-02, 26;
2.398487e-02, 22];

[D0,x00,alpha0,e_sw1,Icr1,dIcr1,all_plots]=calc_sw_intencity_dGauss(data_source,bragg,cut_direction,cut_p,dE,dK);
for i=1:3
    close(all_plots(i));
end
% 
cut_direction=[1,-1,-1];
%
% Points on Q-dE plane to make 1D cuts
cut_p =  [ -3.803427e-01, 150;
-3.749243e-01, 146;
-3.694259e-01, 142;
-3.638440e-01, 138;
-3.581746e-01, 134;
-3.524134e-01, 130;
-3.465559e-01, 126;
-3.405970e-01, 122;
-3.345313e-01, 118;
-3.283529e-01, 114;
-3.220551e-01, 110;
-3.156308e-01, 106;
-3.090721e-01, 102;
-3.023701e-01, 98;
-2.955151e-01, 94;
-2.884960e-01, 90;
-2.813004e-01, 86;
-2.739144e-01, 82;
-2.663220e-01, 78;
-2.585048e-01, 74;
-2.504416e-01, 70;
-2.421077e-01, 66;
-2.334736e-01, 62;
-2.245046e-01, 58;
-2.151582e-01, 54;
-2.053825e-01, 50;
-1.951121e-01, 46;
-1.842634e-01, 42;
-1.727262e-01, 38;
-1.603497e-01, 34;
-1.469190e-01, 30;
-1.321076e-01, 26;
-1.153749e-01, 22];

[D1,x01,alpha1,e_sw1,Icr1,dIcr1,all_plots]=calc_sw_intencity_dGauss(data_source,bragg,cut_direction,cut_p,dE,dK);
for i=1:3
    close(all_plots(i));
end

cut_direction=[-1,-1,-1];
%
% Points on Q-dE plane to make 1D cuts
cut_p =  [-4.213847e-01, 190;
-4.167637e-01, 186;
-4.120904e-01, 182;
-4.073628e-01, 178;
-4.025791e-01, 174;
-3.977372e-01, 170;
-3.928350e-01, 166;
-3.878700e-01, 162;
-3.828399e-01, 158;
-3.777420e-01, 154;
-3.725736e-01, 150;
-3.673315e-01, 146;
-3.620125e-01, 142;
-3.566132e-01, 138;
-3.511298e-01, 134;
-3.455582e-01, 130;
-3.398941e-01, 126;
-3.341327e-01, 122;
-3.282688e-01, 118;
-3.222967e-01, 114;
-3.162102e-01, 110;
-3.100024e-01, 106;
-3.036659e-01, 102;
-2.971922e-01, 98;
-2.905720e-01, 94;
-2.837949e-01, 90;
-2.768493e-01, 86;
-2.697218e-01, 82;
-2.623974e-01, 78;
-2.548588e-01, 74;
-2.470860e-01, 70;
-2.390558e-01, 66;
-2.307407e-01, 62;
-2.221081e-01, 58;
-2.131186e-01, 54;
-2.037238e-01, 50;
-1.938634e-01, 46;
-1.834606e-01, 42;
-1.724145e-01, 38;
-1.605885e-01, 34;
-1.477897e-01, 30;
-1.337293e-01, 26;
-1.179392e-01, 22;
NaN, NaN;
1.089127e-01, 22;
1.247028e-01, 26;
1.387632e-01, 30;
1.515620e-01, 34;
1.633880e-01, 38;
1.744341e-01, 42;
1.848370e-01, 46;
1.946973e-01, 50;
2.040921e-01, 54;
2.130816e-01, 58;
2.217142e-01, 62;
2.300293e-01, 66;
2.380596e-01, 70;
2.458323e-01, 74;
2.533709e-01, 78;
2.606953e-01, 82;
2.678228e-01, 86;
2.747685e-01, 90;
2.815455e-01, 94;
2.881657e-01, 98;
2.946394e-01, 102;
3.009759e-01, 106;
3.071837e-01, 110;
3.132702e-01, 114;
3.192423e-01, 118;
3.251063e-01, 122;
3.308677e-01, 126;
3.365318e-01, 130];

[D2,x02,alpha2,e_sw1,Icr1,dIcr1,all_plots]=calc_sw_intencity(data_source,bragg,cut_direction,cut_p,dE,dK);
for i=1:3
    close(all_plots(i));
end

%
D     = (D0+D1+D2)/3
x0    =(x00+x01+x02)/3
alpha = (alpha0+alpha1+alpha2)/3
